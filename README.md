# DocuSense AI - Plateforme d'Analyse Intelligente de Documents

## üöÄ Vue d'ensemble

DocuSense AI est une plateforme moderne et robuste d'analyse intelligente de documents, con√ßue avec une architecture propre, maintenable et performante. Elle combine des technologies de pointe pour offrir une exp√©rience utilisateur exceptionnelle.

## ‚ú® Fonctionnalit√©s Principales

### üîç Analyse Intelligente
- **Extraction automatique** de donn√©es depuis tous types de documents
- **Classification intelligente** par domaine d'expertise (Juridique, Technique, Administratif, G√©n√©ral)
- **Comparaison de documents** avec d√©tection de diff√©rences
- **Synth√®se multi-documents** avec rapports structur√©s
- **Prompts sp√©cialis√©s** par domaine d'expertise

### ‚öñÔ∏è V√©rification Normative
- **Conformit√© l√©gale** automatique (Code civil, Code de commerce, etc.)
- **V√©rification des normes techniques** (DTU, NF, EN, ISO)
- **Analyse r√©glementaire** (RE2020, RT2012, etc.)
- **D√©tection d'incoh√©rences** et alertes de prescription

### ü§ñ Assistance IA - Configuration Avanc√©e
- **4 providers IA** : OpenAI, Claude, Mistral, Ollama (local)
- **6 strat√©gies de s√©lection** : Priority, Cost, Performance, Fallback, Quality, Speed
- **Syst√®me de priorit√© intelligent** : Recalcul automatique selon les providers actifs
- **Interface adaptative** : Priorit√©s √©ditables en mode "Priority", automatiques pour les autres
- **Configuration adaptative** des cl√©s API
- **Queue d'analyse** avec reprise automatique

### üìÅ Gestion Avanc√©e des Fichiers
- **Formats support√©s** : pdf, docx, doc, txt, eml, msg, xlsx, xls, csv, jpg, jpeg, png, html
- **Visualisation int√©gr√©e** : Texte, images, audio, vid√©o, documents
- **OCR int√©gr√©** pour documents scann√©s (en d√©veloppement)
- **Statuts en temps r√©el** avec indicateurs visuels color√©s
- **Navigation intuitive** avec s√©lecteur de disque et bouton retour parent

## üé® Interface Utilisateur

### üñ•Ô∏è Layout Principal
- **Panneau gauche redimensionnable** : Navigation dans l'arborescence des fichiers
- **Panneau principal** : Affichage des d√©tails et r√©sultats d'analyse
- **Panneaux lat√©raux** : Configuration IA, File d'attente, Analyses termin√©es

### üìÇ Navigation des Fichiers
- **S√©lecteur de disque** : Choix du disque physique √† explorer
- **Bouton retour parent** : Navigation vers le dossier parent
- **Arborescence interactive** : Navigation intelligente avec s√©paration des actions
  - **Clic sur chevron** : Expansion/r√©duction du dossier pour voir son contenu
  - **Clic sur nom du dossier** : Navigation vers ce dossier (charge son contenu)
  - **Logs de debug** : Tra√ßabilit√© compl√®te de la navigation dans la console
- **Arborescence redimensionnable** avec gestion optimis√©e des ascenseurs
  - **Ascenseur unique** : Un seul ascenseur dans l'arborescence (pas de double ascenseur)
  - **Apparition automatique** : L'ascenseur n'appara√Æt que si le contenu d√©passe la hauteur disponible
  - **Espace optimis√©** : Suppression des paddings redondants pour maximiser l'espace d'affichage

### üéØ Actions sur les Fichiers
- **Menu contextuel** : Clic droit pour acc√©der aux actions
- **Analyse IA** : Prompts sp√©cialis√©s par domaine (Juridique, Technique, Administratif, G√©n√©ral)
- **S√©lection multiple** : Clic pour s√©lectionner/d√©s√©lectionner plusieurs fichiers
- **Actions de masse** : Boutons pour analyser, comparer ou retry tous les fichiers s√©lectionn√©s
- **Visualisation** : Un seul fichier √† la fois (d√©sactiv√©e en s√©lection multiple)
- **Feedback visuel** : Encadrement fin, compteurs et messages d'aide contextuels
- **Visualisation** : Affichage int√©gr√© des fichiers

### üé® Design et UX
- **Th√®me sombre/clair** : Basculement automatique avec impl√©mentation technique avanc√©e
  - **Attribut data-theme** : `document.body.setAttribute('data-theme', 'light')` pour le mode jour
  - **CSS variables adaptatives** : Couleurs qui changent automatiquement selon le th√®me
  - **Ic√¥nes dynamiques** : Soleil pour passer en mode jour, lune pour passer en mode nuit
- **Ic√¥nes color√©es** : Tous les √©l√©ments utilisent des couleurs coh√©rentes
  - **Fichiers et dossiers** : Couleur bleu clair uniforme pour tous les √©l√©ments
  - **Panneaux** : Couleurs synchronis√©es via variables CSS (violet, orange, vert)
  - **Th√®me adaptatif** : Couleurs qui s'adaptent automatiquement au mode jour/nuit
  - **S√©lection** : Encadrement fin adaptatif au th√®me jour/nuit
- **Statuts visuels** : Points color√©s pour indiquer l'√©tat des fichiers
  - **Vert** : Analyse termin√©e
  - **Jaune** : En attente de traitement ou en pause (avec effet pulsant)
  - **Bleu** : En cours de traitement (avec effet pulsant)
  - **Rouge** : √âchec
  - **Noir** : Format non support√©
- **Couleurs coh√©rentes** : Palette harmonieuse avec ic√¥nes color√©es
- **Responsive design** : Adaptation mobile et desktop

### ‚öôÔ∏è Panneaux de Configuration
- **Configuration IA** (Bleu) : Gestion des providers et strat√©gies
- **File d'attente** (Jaune) : Suivi des analyses en cours
- **Analyses termin√©es** (Vert) : Consultation des r√©sultats
- **Synchronisation des couleurs** : Ic√¥nes et titres de panneaux harmonis√©s
- **Th√®me jour/nuit** : Basculement automatique avec ic√¥nes adapt√©es

## üèóÔ∏è Architecture Technique

### Backend (Python FastAPI)
- **Framework** : FastAPI avec validation Pydantic
- **Base de donn√©es** : SQLAlchemy avec SQLite/PostgreSQL
- **IA Providers** : OpenAI, Anthropic, Mistral, Ollama
- **OCR** : Tesseract avec support fran√ßais (en d√©veloppement)
- **Cache** : Redis ou fichier JSON
- **Tests** : pytest avec couverture 80%+

#### üîí S√©curit√© Avanc√©e
- **Rate Limiting** : Protection contre les attaques DDoS
- **CORS Restrictif** : Origines autoris√©es limit√©es
- **Cl√© secr√®te s√©curis√©e** : G√©n√©ration automatique 32+ caract√®res
- **Headers de s√©curit√©** : XSS, CSRF protection
- **Trusted Host Middleware** : Protection contre host header attacks

#### ‚ö° Performance Optimis√©e
- **Compression Gzip** : R√©duction 60-80% de la bande passante
- **Monitoring temps r√©el** : M√©triques de performance avec psutil
- **Request ID tracking** : Tra√ßabilit√© compl√®te des requ√™tes
- **Logging structur√©** : Tra√ßabilit√© et debugging avanc√©s

#### üìÅ Modules Centralis√©s
- `core/file_utils.py` : Gestion des formats et extraction d'informations
- `core/database_utils.py` : Utilitaires de base de donn√©es
- `core/status_manager.py` : Gestion des statuts et transitions
- `core/validation.py` : Validation et gestion d'erreurs
- `data/prompts.json` : Prompts IA centralis√©s et configurables

### Frontend (React TypeScript)
- **Framework** : React 18 avec TypeScript strict
- **Styling** : Tailwind CSS avec th√®mes personnalis√©s
- **√âtat global** : Zustand avec persistance et cache intelligent
- **Responsive** : Mobile-first design
- **Accessibilit√©** : Navigation clavier et ARIA labels

#### üöÄ Performance Frontend
- **Code Splitting** : Chunks optimis√©s par fonctionnalit√©
- **Cache intelligent** : Persistance et invalidation automatique
- **Hot Reload optimis√©** : Vite avec configuration avanc√©e
- **Alias de modules** : Imports optimis√©s avec r√©solution de chemins
- **Build optimis√©** : Minification, compression, assets optimis√©s

#### üîÑ D√©veloppement Optimis√©
- **Error handling** : Gestion d'erreurs robuste avec m√©canismes sp√©cifiques
  - **Try/catch** : Gestion d'erreurs dans `loadFilesystemData` et `handleDirectoryNavigation`
  - **Logs d'erreur** : Messages d'erreur d√©taill√©s dans la console avec contexte
  - **Fallback gracieux** : Interface reste fonctionnelle m√™me en cas d'erreur
- **Timeout management** : Gestion des timeouts avec AbortController
  - **Requ√™tes API** : Timeout configurable pour √©viter les blocages
  - **Annulation** : Possibilit√© d'annuler les requ√™tes en cours
  - **Retry automatique** : Tentatives de reconnexion en cas d'√©chec
- **State management** : Zustand avec devtools et persist middleware
- **Logs de debug frontend** : Tra√ßabilit√© compl√®te avec logs d√©taill√©s
  - **Navigation** : Logs avec emojis pour tracer les clics et la navigation
  - **Donn√©es backend** : Debug des r√©ponses API et des donn√©es re√ßues
  - **Console accessible** : F12 pour voir les logs de debug en temps r√©el

#### üìÅ Architecture Modulaire
- `components/UI/` : Composants r√©utilisables (Button, Modal, etc.)
- `components/Layout/` : Composants de mise en page (LeftPanel, MainPanel)
- `components/FileManager/` : Gestion des fichiers (FileTree avec navigation int√©gr√©e)
- `components/Config/` : Configuration IA (ConfigWindow, ConfigContent)
- `components/Queue/` : File d'attente (QueuePanel, QueueContent)
- `hooks/` : Hooks personnalis√©s (useFileOperations, useColors, etc.)
- `utils/` : Utilitaires centralis√©s (fileUtils, constants, colors, etc.)
- **Fichiers de couleurs** : `utils/colors.ts` et `hooks/useColors.ts`
- `stores/` : Gestion d'√©tat avec Zustand
- **D√©l√©gation intelligente** : LeftPanel d√©l√®gue la gestion de l'arborescence √† FileTree
- **Composants refactoris√©s** : ConfigContent et QueueContent pour r√©utilisation dans MainPanel
- **Syst√®me de couleurs centralis√©** : Toutes les couleurs d√©finies dans `utils/colors.ts`

#### üìä Synchronisation Intelligente en Temps R√©el
- **Statuts en temps r√©el** avec indicateurs visuels color√©s et animations
- **Synchronisation adaptative** : 
  - Base : 8-10 secondes (LeftPanel/FileTree)
  - Actions en cours : 1-3 secondes (suivi intensif)
  - Imm√©diate : Apr√®s chaque action utilisateur
- **Suivi de progression** : Synchronisation continue pendant le traitement
- **Arr√™t automatique** : Synchronisation intensive s'arr√™te quand l'action est termin√©e
- **Queue d'analyse** : Rechargement automatique des √©l√©ments en cours et du statut global
- **Conditionnelle** : Synchronisation uniquement quand un disque est s√©lectionn√©
- **Communication bidirectionnelle** : √âv√©nements CustomEvent entre LeftPanel et Layout
- **√âtat synchronis√©** : activePanel partag√© entre composants pour coh√©rence des couleurs

## üöÄ D√©marrage Rapide

### Pr√©requis
- **Python 3.8+**
- **Node.js 16+**
- **npm 8+**

### Installation et D√©marrage

#### Option 1 : D√©marrage Automatique Optimis√© (Recommand√©)
```bash
# Cloner le projet
git clone <repository-url>
cd docusense-ai

# D√©marrer les serveurs automatiquement avec gestion intelligente des processus
.\scripts\dev_start.ps1
```

#### Option 2 : D√©marrage Manuel avec Gestion Intelligente

**Backend :**
```bash
# V√©rifier et nettoyer les ports
.\scripts\manage_ports.ps1 check
.\scripts\manage_ports.ps1 clean
Start-Sleep -Seconds 3

# D√©marrer le backend (depuis la racine du projet)
cd backend
venv\Scripts\python.exe main.py
```

**Frontend :**
```bash
# V√©rifier et nettoyer les ports
.\scripts\manage_ports.ps1 check
.\scripts\manage_ports.ps1 clean

# D√©marrer le frontend (depuis la racine du projet)
cd frontend
npm run dev
```

### Ports et Acc√®s
- **Backend** : http://localhost:8000
- **Frontend** : http://localhost:3000
- **API Docs** : http://localhost:8000/docs

## üìÅ Structure du Projet

```
docusense-ai/
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/           # Endpoints API
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ core/          # Modules centralis√©s
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ file_utils.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database_utils.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ status_manager.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ validation.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ data/          # Fichiers de donn√©es centralis√©s
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ prompts.json  # Prompts IA centralis√©s et configurables
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models/        # Mod√®les de donn√©es
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/      # Services m√©tier
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils/         # Utilitaires
‚îÇ   ‚îú‚îÄ‚îÄ logs/              # Logs d'application
‚îÇ   ‚îú‚îÄ‚îÄ venv/              # Environnement virtuel Python
‚îÇ   ‚îú‚îÄ‚îÄ main.py            # Point d'entr√©e
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt   # D√©pendances Python
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/    # Composants React
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hooks/         # Hooks personnalis√©s
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/      # Services API
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stores/        # Gestion d'√©tat Zustand
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils/         # Utilitaires
‚îÇ   ‚îú‚îÄ‚îÄ public/            # Assets statiques
‚îÇ   ‚îî‚îÄ‚îÄ package.json       # D√©pendances Node.js
‚îú‚îÄ‚îÄ scripts/               # Scripts de d√©marrage et gestion
‚îú‚îÄ‚îÄ logs/                  # Logs globaux
‚îú‚îÄ‚îÄ README.md             # Documentation principale
‚îú‚îÄ‚îÄ üìö DOCUMENTATION_INDEX.md          # Index de tous les documents
‚îú‚îÄ‚îÄ COLORS_GUIDE.md       # Guide du syst√®me de couleurs
‚îú‚îÄ‚îÄ COLORS_CENTRALIZATION_SUMMARY.md  # R√©sum√© centralisation couleurs
‚îú‚îÄ‚îÄ REFACTORING_REPORT.md # Rapport de refactoring
‚îî‚îÄ‚îÄ CLEANUP_SYNCHRONIZATION_REPORT.md # Rapport de nettoyage
```

## üîß Configuration

### Variables d'Environnement Backend
```bash
# Base de donn√©es
DATABASE_URL=sqlite:///./docusense.db

# S√©curit√©
SECRET_KEY=your-secret-key-here
CORS_ORIGINS=["http://localhost:3000"]

# IA Providers
OPENAI_API_KEY=your-openai-key
ANTHROPIC_API_KEY=your-anthropic-key
MISTRAL_API_KEY=your-mistral-key
OLLAMA_BASE_URL=http://localhost:11434
```

### Configuration Frontend
```typescript
// src/utils/constants.ts
export const API_BASE_URL = 'http://localhost:8000'
export const SYNC_INTERVAL = 5000 // 5 secondes
```

### üé® Syst√®me de Couleurs Centralis√©

Toutes les couleurs de l'interface sont centralis√©es pour faciliter les modifications :

#### Fichiers de couleurs
- **`frontend/src/utils/colors.ts`** : D√©finition de toutes les couleurs
- **`frontend/src/hooks/useColors.ts`** : Hooks pour utiliser les couleurs
- **`COLORS_GUIDE.md`** : Guide complet d'utilisation

### üîß Optimisations Interface

#### Animations d'Activation
- **Scale + Ring** : Au lieu de remplissage de couleur qui masque les ic√¥nes
- **Pulsation** : Animation continue pour les boutons actifs
- **Transitions fluides** : 300ms pour tous les changements d'√©tat

#### Champs de Saisie
- **≈íil unique** : Utilisation de l'≈ìil natif du navigateur pour les champs password
- **Suppression redondance** : Plus de double ≈ìil dans les champs de cl√©s API
- **Interface √©pur√©e** : Moins d'√©l√©ments visuels superflus

#### Couleurs principales
```typescript
// Couleurs des panneaux
config: '#3b82f6'    // Bleu pour Configuration IA
queue: '#eab308'     // Jaune pour File d'attente  
analyses: '#4ade80'  // Vert pour Analyses termin√©es

// Couleurs de statut
pending: '#eab308'   // Jaune - En attente
processing: '#3b82f6' // Bleu - En cours
completed: '#22c55e' // Vert - Termin√©
failed: '#ef4444'    // Rouge - √âchec
```

#### Utilisation dans les composants
```typescript
import { useColors, usePanelColors, useStatusColors } from '../hooks/useColors';

// Hook principal
const { colors, colorMode } = useColors();

// Hook sp√©cialis√© pour les panneaux
const { config, queue, analyses } = usePanelColors();

// Hook sp√©cialis√© pour les statuts
const { pending, completed, getStatusColor } = useStatusColors();
```

## üß™ Tests

### Backend
```bash
cd backend
venv\Scripts\python.exe -m pytest tests/ -v --cov=app --cov-report=html
```

### Frontend
```bash
cd frontend
npm test
npm run test:coverage
```

## üìä Monitoring et M√©triques

### Logs
- **Backend** : `backend/logs/` et `logs/`
- **Frontend** : Console navigateur (F12)
- **Debug** : Logs d√©taill√©s avec emojis pour la navigation

### M√©triques de Performance
- **Temps de r√©ponse API** : Monitoring automatique
- **Utilisation m√©moire** : psutil integration
- **Queue d'analyse** : Statuts en temps r√©el

## üîÑ D√©ploiement

### Production
```bash
# Build frontend
cd frontend
npm run build

# D√©marrage backend production
cd backend
venv\Scripts\python.exe main.py --env production
```

### Docker (Optionnel)
```bash
docker-compose up -d
```

## ü§ù Contribution

### D√©veloppement
1. Fork le projet
2. Cr√©er une branche feature (`git checkout -b feature/AmazingFeature`)
3. Commit les changements (`git commit -m 'Add AmazingFeature'`)
4. Push vers la branche (`git push origin feature/AmazingFeature`)
5. Ouvrir une Pull Request

### Standards de Code
- **Backend** : PEP 8, type hints, docstrings
- **Frontend** : ESLint, Prettier, TypeScript strict
- **Tests** : Couverture 80%+ requise

## üìù Licence

Ce projet est sous licence MIT. Voir le fichier `LICENSE` pour plus de d√©tails.

## üìö Documentation et Ressources

### Documentation Principale
- **README.md** : Documentation principale du projet
- **üìö Index** : `DOCUMENTATION_INDEX.md` - Index complet de tous les documents
- **API Docs** : http://localhost:8000/docs
- **Architecture** : `ARCHITECTURE_CENTRALISEE.md`

### Rapports et Guides
- **Refactoring** : `REFACTORING_REPORT.md` - Rapport d√©taill√© du refactoring
- **Nettoyage** : `CLEANUP_SYNCHRONIZATION_REPORT.md` - Rapport de nettoyage et synchronisation
- **Couleurs** : `COLORS_GUIDE.md` - Guide complet du syst√®me de couleurs centralis√©
- **Centralisation** : `COLORS_CENTRALIZATION_SUMMARY.md` - R√©sum√© de la centralisation des couleurs

## üÜò Support

### Probl√®mes Courants
- **Ports occup√©s** : Utiliser `.\scripts\manage_ports.ps1 clean`
- **Environnement virtuel** : Toujours utiliser `venv\Scripts\python.exe`
- **Frontend port 3000** : Forcer le port avec `taskkill /F /IM node.exe /T`

### Contact
- **Issues** : GitHub Issues
- **Discussions** : GitHub Discussions 